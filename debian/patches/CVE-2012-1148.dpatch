#! /bin/sh /usr/share/dpatch/dpatch-run

@DPATCH@
--- expat-2.0.1.orig/lib/xmlparse.c	2009/12/29 18:42:05	1.166
+++ expat-2.0.1/lib/xmlparse.c	2010/02/25 18:35:36	1.167
@@ -6122,12 +6122,13 @@
   }
   if (pool->blocks && pool->start == pool->blocks->s) {
     int blockSize = (int)(pool->end - pool->start)*2;
-    pool->blocks = (BLOCK *)
+    BLOCK *temp = (BLOCK *)
       pool->mem->realloc_fcn(pool->blocks,
                              (offsetof(BLOCK, s)
                               + blockSize * sizeof(XML_Char)));
-    if (pool->blocks == NULL)
+    if (temp == NULL)
       return XML_FALSE;
+    pool->blocks = temp;
     pool->blocks->size = blockSize;
     pool->ptr = pool->blocks->s + (pool->ptr - pool->start);
     pool->start = pool->blocks->s;
